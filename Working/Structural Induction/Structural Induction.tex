\documentclass[12pt]{article}

\usepackage{amssymb, amsmath, amsfonts}
\usepackage{mathtools}
\usepackage{braket}
\usepackage{bussproofs}
\usepackage{amsthm}

\makeatletter
\newtheoremstyle{break}% name
    {12pt}%         Space above, empty = `usual value'
    {12pt}%         Space below
    {\addtolength{\@totalleftmargin}{1.5em}
     \addtolength{\linewidth}{-3em}
     \parshape 1 1.5em \linewidth
     \itshape}% Body font
    {}%         Indent amount (empty = no indent, \parindent = para indent)
    {\bfseries}% Thm head font
    {}%        Punctuation after thm head
    {\newline}% Space after thm head: \newline = linebreak
    {}%         Thm head spec
\theoremstyle{break}
\newtheorem{definition}{Definition}[section]
\theoremstyle{break}
\newtheorem{theorem}{Theorem}[section]
\theoremstyle{break}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{break}
\newtheorem{lemma}[theorem]{Lemma}
\theoremstyle{break}
\newtheorem{informal definition}[definition]{Informal Definition}


\newcommand{\bv}[1]{\boldsymbol{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\bc}[1]{\bv{\mc{#1}}}
\newcommand{\qq}[1]{``#1''}

\begin{document}
\title{Structural Recursion}
\author{Justin Gerber}
\date{\today}
\maketitle

\section{Introduction}

\section{Natural Numbers Induction}

\begin{definition}[Set Successor]
If $x$ is a set then we define the successor of $x$ by
$$
x^+ = x \cup \{x\}
$$
This is added as a definition to set theory via the formula:
$$
y \in x \iff (y=x \lor y\in x)
$$
This formula says that $y$ is the successor of $x$.
Given the existence of $x$, we can show the existence of such a set $y$ using the pairing and union, and we can show the uniqueness of this set using the axiom of extensionality.
\end{definition}

\begin{definition}[Inductive]
In set theory, we say $S$ is an inductive set if

$$
\emptyset \in S \land \forall x\in S(x^+ \in S)
$$
\end{definition}

\begin{definition}[Axiom of Infinity]
The Axiom of Infinity states that there exists an inductive set.
That is
$$
\exists S (\emptyset \in S \land \forall x\in S(x^+ \in S))
$$
\end{definition}

\begin{definition}[Inductive Closure]
Let
$$
\mathcal{I}_S = \{A \in \mathcal{P}(S): A\text{ is inductive}\}
$$
We define the inductive closure of $S$ as $\mathbb{N}_S$ by
$$
\mathbb{N}_S = \bigcap \mathcal{I}_S
$$
\end{definition}

\begin{theorem}[Inductive Closure of Inductive Set is Inductive]
If $S$ is inductive then $S\in\mathcal{I}_S$.
Because each $A \in \mathcal{I}_S$ is inductive we have $\emptyset \in A$ so that $\emptyset \in \mathbb{N}_S = \bigcap\mathcal{I}_S$.
Now suppose $x\in \mathbb{N}_S$.
This means $x\in A$ for each $A\in \mathcal{I}_S$.
But since each $A$ is inductive, this means $x^+ \in A$.
Since this holds for each $A \in \mathcal{I}_S$ we have $x^+ \in \mathbb{N}_S$
\end{theorem}

\begin{corollary}[Inductive Closure of Inductive Set is a Subset of Any Inductive Subset]
If $S$ is inductive and $S' \subset S$ is inductive then $S' \in \mathcal{I}$ so $\mathbb{N}_S \subset S' \subset S$.
\end{corollary}

\begin{theorem}[Uniqueness of Inductive Closure]
\label{thm:uniqueinductiveclosure}
Suppose $S$ and $T$ are inductive.
Consider
\begin{align*}
\mathbb{N}_S &\subset S \cap \mathbb{N}_T \subset \mathbb{N}_T\\
\mathbb{N}_T &\subset T \cap \mathbb{N}_S \subset \mathbb{N}_S
\end{align*}
so we see $\mathbb{N}_T = \mathbb{N}_S$.
\end{theorem}

\begin{definition}[Natural Numbers]
The Axiom of Infinity combined with Theorem \ref{thm:uniqueinductiveclosure} guarantees the existence of an inductive set $S$ along with a unique inductive closure $\mathbb{N}_S$.
Since this inductive closure is unique we may define $\mathbb{N} = \mathbb{N}_S$.
We call $\mathbb{N}$ the natural numbers.
\end{definition}

\begin{definition}[Numbers]
We define
$$
0 = \emptyset
$$
We also define $1 = 0^+$, $2=1^+ = (0^+)^+ \ldots$.
These are names for the elements of the natural numbers.
\end{definition}

\begin{theorem}[Induction Principle \# 1]
\label{thm:indprinc1}
Suppose $S \subset \mathbb{N}$ and $S$ is inductive.
We know
$$
\mathbb{N} = \mathbb{N}_S \subset S
$$
So we must have $S = \mathbb{N}_S$
\end{theorem}

\begin{theorem}[Induction Principle \#2]
\label{thm:natindprinc2}
Suppose $\phi$ is a formula which has $n$ appearing as a free variable.
Suppose we have proven
\begin{align}
&\phi[0/n] \tag{IH1}\label{eq:natIH1}\\
&\forall n \in \mathbb{N}(\phi \implies \phi[n^+/n]) \tag{IH2}\label{eq:natIH2}
\end{align}

Consider then the set

$$
S = \{n\in \mathbb{N}: \phi\}
$$

We will show that $S\subset \mathbb{N}$ is inductive so, that by Theorem \ref{thm:indprinc1}, we have $S = \mathbb{N}$ from which we can conclude
$$
\forall n \in \mathbb{N}(\phi)
$$

First, by Eq. \ref{eq:natIH1} we see that $0\in S$.
Next, by Eq. \ref{eq:natIH2} we see that if $n\in S$ then $n^+ \in S$.
These two facts mean that $S$ is inductive.
Therefore, from Eqs. \ref{eq:natIH1} and \ref{eq:natIH2} we can conclude $\forall n \in \mathbb{N}(\phi)$.

\end{theorem}



\section{Structural Induction and Recursion}

\begin{definition}[Structurally Inductive]
Suppose $U$ is a set and $\mathcal{F}$ is a family of functions such that $f \in \mathcal{F}$ implies there is some $n\in \mathbb{N}$ such that $f: U^n \to U$.
Suppose $B \subset U$.

Suppose $C \subset U$.
We say $C$ is $(U, B, \mathcal{F})$-inductive if
\begin{itemize}
\item{$B\subset C$}
\item{For all $f\in \mathcal{F}$ if $f:U^n\to U$, $\bv{c}\in C^n \subset U^n = \text{Dom}(f)$ implies $f(\bv{c})\in C$. In other words, $C$ is closed under all $f\in \mathcal{F}$. More formally
$$
\forall f\in \mathcal{F}(\forall n\in \mathbb{N}(f:U^n \to U \implies \forall \bv{c} \in C^n (f(\bv{c}) \in C)))
$$}
\end{itemize}
\end{definition}

\begin{theorem}[$U$ is $(U, B, \mathcal{F})$-inductive]
\label{thm:Uinductive}
We know $B\subset U$.
We also know that for all $f\in \mathcal{F}$ with $f:U^n \to U$ that for all $\bv{u}\in U^n$ that $f(\bv{u}) \in U$.
\end{theorem}

\begin{definition}[Structural Inductive Closure]
Let
$$
\mathcal{C} = \{C\in \mathcal{P}(U): C \text{ is } (U, B, \mathcal{F})\text{-inductive}\}
$$
We then define the $(U, B, \mathcal{F})$-closure as
$$
\mathbb{N}_{(U, B, \mathcal{F})} = \bigcap \mathcal{C}
$$
\end{definition}

\begin{theorem}[Structurally Inductive Subset]
\label{thm:indsubset}
Suppose $C$ is $(U, B, \mathcal{F})$-inductive.
Then $\mathbb{N}_{(U, B, \mathcal{F})} \subset C$.
\end{theorem}

\begin{corollary}[Structural Induction Principle \# 1]
Suppose $C$ is $(U, B, \mathcal{F})$-inductive and $C \subset \mathbb{N}_{(U, B, \mathcal{F})}$.
By Theorem \ref{thm:indsubset} we have $\mathbb{N}_{(U, B, \mathcal{F})} \subset C$ so we have $C = \mathbb{N}_{(U, B, \mathcal{F})}$.
\end{corollary}

\begin{theorem}[Structural Induction Principle \# 2]
Consider $C = \mathbb{N}_{(U, B, \mathcal{F})}$.
Suppose $\phi$ is a formula which has $c$ appearing as a free variable.
The second structural induction principle states the following.
Suppose we have proven
\begin{equation}
\tag{IH1}
\label{eq:indhyp1}
\forall b \in B: \phi[b/c]
\end{equation}
\small
\begin{equation}
\tag{IH2}
\label{eq:indhyp2}
\forall f \in \mathcal{F}(\forall n \in \mathbb{N}(f:U^n \to U \implies (\forall \bv{c}\in C^n(\forall i \in [n](\phi[\bv{c}_i/c]) \implies \phi[f(\bv{c})/c]))))
\end{equation}
\normalsize
Then we may conclude

$$
\forall c \in C (\phi)
$$

We prove this as follows.
Let
$$
\tilde{C} = \{c \in C:\phi\}
$$

We will prove that $\tilde{C} = C$.
We see that $\tilde{C} \subset C = \mathbb{N}_{(U, B, \mathcal{F})}$.
We will show that $\tilde{C}$ is $(U, B, \mathcal{F})$-inductive so that $\tilde{C} = \mathbb{N}_{(U, B, \mathcal{F})}$ by Theorem \ref{thm:indsubset}.

By the first induction hypothesis, Eq. \ref{eq:indhyp1}, (the base case) we see that $B\subset \tilde{C}$.

For the second structurally inductive condition we use the second induction hypothesis Eq. \ref{eq:indhyp2} (the inductive step).
We must show that, for each $f\in \mathcal{F}$ with $f:U^n \to U$ that $\forall \bv{c} \in \tilde{C}^n$ that $f(\bv{c})\in \tilde{C}$.
That is, $\phi[f(\bv{c})/c]$ holds.
But if $\bv{c}\in \tilde{C}^n$ then we have that $\forall i \in [n] (\bv{c}_i \in \tilde{C})$ which means that $\phi[\bv{c}_i/c]$ holds.
But then, by Eq. \ref{eq:indhyp2}, we have that $\phi[f(\bv{c})/c]$ holds so that $f(\bv{c}) \in \tilde{C}$.
This means that $\tilde{C}$ is inductive so that $\tilde{C} = \mathbb{N}_{(U, B, \mathcal{F})}$ so that $\phi$ holds for all $c \in C$.

\end{theorem}

\begin{lemma}[Tuple Selection]
\label{lem:tupleselection}
Suppose $\phi$ is a formula with $y$ and $i$ free and $Y$ is a set.
We will prove that
$$
\forall n\in \mathbb{N}(\forall i \in[n] (\exists y \in Y(\phi))\implies \exists \bv{y}\in Y^n (\forall i \in [n](\phi[\bv{y}_i/y])))
$$
We will prove this by induction using Theorem \ref{thm:natindprinc2}

For the base case suppose $n=1$.
Then we have $i=0$ and we must prove
$$
\exists y \in Y(\phi[0/i]) \implies \exists \bv{y}\in Y^1(\phi[\bv{y}_0/y][0/i])
$$
This follows because we can always pair $y$ with $0$ into an ordered pair $\braket{0, y}$ and we can then collect this ordered pair into a set $\bv{y} = \{\braket{0, y}\} \in Y^1$ which satisfied $\bv{y}_0 = y$ so that $\phi[\bv{y}_0/y][0/i]$.

For the induction step we assume that for some $n$ we have
$$
\forall i \in [n] (\exists y \in Y(\phi)) \implies \exists \bv{y}\in Y^n(\forall i \in [n] (\phi[\bv{y}_i/y]))
$$

Now consider $n+1$ and suppose
$$
\forall i \in [n+1] (\exists y \in Y (\phi))
$$
In particular this means $\exists y' \in Y (\phi[y'/y][n/i])$.
Recall that $\bv{y}' \in Y^{n+1}$ means that $\bv{y}': [n+1] \to Y$ which means $\bv{y}' \subset [n+1] \times Y$ such that $\bv{y}'$ contains one ordered pair whose first element is $i$ for each $i \in [n+1]$.
Recall that we already know there exists $\bv{y}\in Y^n$ which is a collection of ordered pairs whose for element $i$ satisfies $i\in [n]$. satisfies $\phi[\bv{y}_i/y]$ for each $i\in n$.
If we add the tuple $\braket{n, y'}$ to $\bv{y}$ we get
$$
\bv{y}' = \bv{y} \cup \{\braket{n, y'}\}
$$
We get $\bv{y}': [n+1] \to Y$ so that $\bv{y}' \in Y^{n+1}$ and we have for each $i \in [n+1]$ that $\phi[\bv{y}_i/y]$ holds.

By induction, we may then conclude
$$
\forall n \in \mathbb{N}(\forall i \in [n](\exists y\in Y(\phi)) \implies \exists \bv{y}\in Y^n(\forall i \in [n](\phi[\bv{y}_i/y])))
$$
\end{lemma}


\begin{corollary}[Unique Tuple Selection]
\label{cor:uniquetupleselection}
Suppose $\phi$ is a formula with $y$ and $i$ free and $Y$ is a set.
Let $\psi = \phi \land \forall y' (\phi[y'/y] \implies y'=y)$.
Using $\psi$ with Lemma \ref{lem:tupleselection} yields
\begin{align*}
\forall n \in \mathbb{N} \big(& \forall i \in [n] (\exists y(\phi \land \forall y' (\phi[y'/y] \implies y'=y)))\\
& \implies \exists \bv{y}\in Y^n(\forall i \in [n](\phi[\bv{y}_i/y] \land \forall y' (\phi[y'/y] \implies y'=\bv{y}_i))) \big)
\end{align*}

The antecedent is equivalent to
$$
\forall i \in [n] (\exists!y (\phi))
$$

The consequent can be manipulated

$$
\exists \bv{y} \in Y^n (\forall i \in [n](\phi[\bv{y}_i/y])\land \forall i\in [n](\forall y'(\phi[y'/y] \implies y'=\bv{y}_i)))
$$

Consider
$$
\forall i \in [n] (\forall y' (\phi[y'/y] \implies y' = \bv{y_i}))
$$
consider then $\bv{y}' \in Y^n$.
We have
$$
\forall \bv{y}' \in Y^n (\forall i \in [n](\phi[\bv{y}'_i/y] \implies \bv{y}'_i = \bv{y}_i))
$$
This can be broken into
$$
\forall \bv{y}' \in Y^n (\forall i \in [n](\phi[\bv{x}_i/x][\bv{y}'_i/y]) \implies \forall i \in [n](\bv{y}_i' = \bv{y}_i))
$$
But the antecedent here is equivalent to
$$
\bv{y}' = \bv{y}
$$
Unwrapping this work we come back to
$$
\exists \bv{y}\in Y^n(\forall i \in [n](\phi[\bv{y}_i/y])\land \forall \bv{y}'\in Y^n(\forall i \in [n](\phi[\bv{y}'_i/y]) \implies \bv{y}' = \bv{y}))
$$
which is equivalent to
$$
\exists! \bv{y}\in Y^n (\forall i \in [n](\phi[\bv{y}_i/y]))
$$
So we conclude
$$
\forall n \in \mathbb{N} (\forall i\in [n] (\exists! y(\phi)) \implies \exists! \bv{y}\in Y^n(\forall i \in [n](\phi[\bv{y}_i/y])))
$$

\end{corollary}

\begin{definition}[Map]
Suppose $f:X \to Y$ and $n\in \mathbb{N}$.
We define
\begin{align}
f^{(n)} =& \{z \in X^n \times Y^n: \exists \bv{x} \in X^n \Big(\exists \bv{y} \in Y^n \big(z=\braket{\bv{x}, \bv{y}} \land \forall i \in [n]( \bv{y}_i = f(\bv{x}_i))\big)\Big)\}\\
=& \{\braket{\bv{x}, \bv{y}} \in X^n \times Y^n: x\in X^n \land y \in Y^n \land \forall i \in [n] (\bv{y}_i = f(\bv{x}_i))\}
\end{align}

We see that $f^{(n)}\subset X^n \times Y^n$ is a relation between $X^n$ and $Y^n$.
Suppose $\boldsymbol{x}\in X^n$.
Because $f:X \to Y$ we know that for each $i\in n$ there exists a unique $y\in Y$ with $y=f(\bv{x}_i)$.
This means that, by Theorem \ref{cor:uniquetupleselection} there exists a unique $\bv{y}\in Y^n$ such that $\bv{y}_i = f(\bv{x}_i)$ for each $i\in n$ so that $\braket{\bv{x}, \bv{y}}\in f^{(n)}$ showing that $f^{(n)}$ is a total relation.
Because the $\bv{y}$ is unique, we have that $f^{(n)}$ is also a functional relation.
Because $f^{(n)}$ is a total functional relation this means $f^{(n)}$ is a function $f^{(n)}:X^n \to Y^n$.
\end{definition}

\begin{theorem}[Structural Recursion Theorem]
Consider $C = \mathbb{N}_{(U, B, \mathcal{F})}$.
Suppose we have a set $S$ and a function $h_B:B \to S$.

Suppose that for all $f\in \mathcal{F}$ we have that $f|_{C^n}$ is injective and that for all $f, f' \in \mathcal{F}$ with $f:U^n \to U$ and $f': U^{n'} \to U$ we have that $\text{Img}(f|_{C^n}) \cap \text{Img}(f'|_{C^{n'}}) = \emptyset$ and $\text{Img}(f|_{C^n}) \cap B = \emptyset$, that is, the ranges of each $f\in \mathcal{F}$ restricted to $C^n$ are all pairwise disjoint and disjoint with $B$.

Suppose also there is a set $\tilde{\mathcal{F}}$ and a bijection $\mathcal{B}: \mathcal{F} \to \tilde{\mathcal{F}}$ such that if $f\in \mathcal{F}$ with $f: U^n \to U$ then $\mathcal{B}(f): S^n \to S$.
That is, $\tilde{\mathcal{F}}$ is a family of functions on elements of $S$ corresponding to the family of functions $\mathcal{F}$ acting on elements of $C$.

We define
$$
\tilde{f} = \mathcal{B}(f)
$$

The structural recursion theorem states that, under the above assumptions, there exists a unique function $h:C \to S$ where $h$ satisfies
\begin{align*}
h|_B = h_B \\
\end{align*}
and, if $f\in \mathcal{F}$ with $f:U^n \to U$ and $\bv{c} \in C^n$ then
$$
h(f(\bv{c})) = \tilde{f}(h^{(n)}(\bv{c}))
$$

We prove this as follows.
We seek a total functional relation $h \subset C\times S$.
We will extract his relation from a larger collection of relations $G$ satisfying relevant properties.

\tiny
\begin{align*}
H = \{&A \in \mathcal{P}(C \times S): \\
&\forall b \in B (\Braket{b, h_B(b)} \in A) \land \\
&\forall f \in \mathcal{F}(\forall n \in \mathbb{N}(f:U^n \to U \implies \forall \bv{c} \in C^n (\forall \bv{s}\in S^n (\forall i \in n(\braket{\bv{c}_i, \bv{s}_i} \in A) \implies \braket{f(\bv{c}), \tilde{f}(\bv{s})}\in A))))\}
\end{align*}

\normalsize
We then define

$$
h = \bigcap H
$$

We must show that $h: C \to S$ meaning that $h$ is a total functional relation.
$h$ being total means $\forall c \in C(\exists s\in S(\braket{c, s} \in h))$.
$h$ being functional means
$$
\forall c \in C(\forall s, s' \in S((\braket{c, s}\in h \land \braket{c, s'}\in h) \implies s=s'))
$$
We will first prove $h$ is total by induction.

First, if we have $b \in B \subset C$ then we know that for each $A \in H$ we have $\braket{b, h_B(b)}\in H$ so, by $h = \bigcap H$ we have $\Braket{b, h_B(b)} \in h$.

Now consider $f\in \mathcal{F}$ with $f:U^n \to U$ and consider $\bv{c} \in C^n$.
For the induction hypothesis we have that for each $c\in C$ there exists $s\in S$ with $\braket{c, s} \in h$.
In particular this means that for each $i \in n$ there exists an $s$ such that $\braket{\bv{c}_i, s} \in h$.
Lemma \ref{lem:tupleselection} then tells us there exists $\bv{s}\in S^n$ such that $\braket{\bv{c}_i, \bv{s}_i} \in h$ for each $i\in n$.
This means that $\braket{\bv{c}_i, \bv{s}_i} \in A$ for each $A \in H$.
The characterization of $A \in H$ means we must have $\braket{f(\bv{c}), \tilde{f}(\bv{s})} \in A$ for each $A \in H$.
This implies $\braket{f(\bv{c}), \tilde{f}(\bv{s})}\in h$.
This completes the structural induction proof that $h$ is a total relation.

We now prove $h$ is a functional relation, again by induction.

Suppose $b\in B \subset C$ and $\braket{b, s}, \braket{b, s'} \in h$.
We know from the definition $h = \bigcap H$ and the definition of $h$ that $\braket{b, h_B(b)} \in h$.
Suppose, for contradiction, that $s \not = h_B(b)$.
$\braket{b, s}\in h$ means there exists an $A\in H$ with $\braket{b, s}\in A$.
Consider $A' = A \setminus\{\braket{b, s}\}$.
We will show $A'\in H$ which will contradict $\braket{b, s} \in h = \bigcap H$ meaning we must have $s = h_B(b)$.
The same argument will follow for $s'$ so that $s=s' = h_B(b)$.

We show $A' \in H$.
First consider $b'\in B$.
We know $\braket{b', h_B(b')} \in A$.
If $b' \not = b$ then we also have $\braket{b', h_B(b')} \in A'$ because $b' \not = b$.
If $b' = b$ then $\braket{b', h_B(b')} \in A'$ because $s \not = h_B(b)$.
Now suppose $f\in \mathcal{F}$ with $f:U^n \to U$.
Consider $\bv{c} \in C^n$ and $\bv{s} \in S^n$.
We must show that
$$
\forall i \in n(\braket{\bv{c}_i, \bv{s}_i} \in A') \implies \braket{f(\bv{c}), \tilde{f}(\bv{s})} \in A'
$$
Suppose $\forall i \in n(\braket{\bv{c}_i, \bv{s}_i} \in A'$.
Then we know $\forall i \in n(\braket{\bv{c}_i, \bv{s}_i} \in A$ which implies $\braket{f(\bv{c}), \tilde{f}(\bv{s})}\in A$.
Because the range of $f|_{C^n}$ is disjoint from $B$ we must have $f(\bv{c}) \not= b$.
But this means $\braket{f(\bv{c}), \tilde{f}(\bv{s})} \in A'$.
This concludes the proof that $A' \in H$ and therefore that, for all $b\in B$, $\braket{b, s}, \braket{b, s'}\in h$ implies $s=s'=h_B(b)$.

We now perform the induction step.
That is, we assume for $f\in \mathcal{F}$ with $f:U^n \to U$ and $\bv{c}\in C^n$ that for all $i\in [n]$ that, for $s, s' \in S$,  if $\braket{\bv{c}_i, s}, \braket{\bv{c}_i, s'} \in h$ that $s=s'$.
From this we must prove that, for $s, s'\in S$, that $\braket{f(\bv{c}), s}, \braket{f(\bv{c}), s'} \in h$ implies $s=s'$.
Because $h$ is total we have that $\forall i \in [n] (\exists t\in S(\braket{\bv{c}_i, t}\in h))$.
Furthermore, by the induction hypothesis, this $t$ is unique for each $i$.
This means, by Corollary \ref{cor:uniquetupleselection} that $\exists! \bv{t}\in S^n (\forall i \in [n](\braket{\bv{c}_i, \bv{t}_i}\in h))$.
Because $h = \bigcap H$ we have that $\exists! \bv{t}\in S^n (\forall A \in H(\forall i \in [n](\braket{\bv{c}_i, \bv{t}_i} \in A)))$, that is, the same unique $\bv{t}$ satisfies the condition for each set $A$.
This implies, by the definition of $A\in H$, that there exist a unique $\bv{t}$ such that $\braket{f(\bv{c}), \tilde{f}(\bv{t})} \in A$ for each $A\in h$ and therefore that $\braket{f(\bv{c}), \tilde{f}(\bv{t})}\in h$.
Consider $A\in H$ with $\braket{f(\bv{c}), \tilde{f}(\bv{t})}\in A$.
Consider then $A' = A\setminus \{\braket{f(\bv{c}), s}\}$.
We suppose, for the sake of contradiction, that $s \not = \tilde{f}(\bv{t})$.
We will show that $A' \in H$.
First consider $b\in B \subset C$.
We know $\braket{b, h_B(b)} \in A$, but, because the range of $f|_{C^n}$ is disjoint from $B$ we have $f(\bv{c}) \not = b$ so $\braket{b, h_B(b)}\in A'$.
Now consider $f'\in \mathcal{F}$ with $f':U^{n'} \to U$ and consider $\bv{c}' \in C^{n'}$ and $\bv{t}'\in S^{n'}$.
Suppose that for all $i \in [n']$ that $\braket{\bv{c}'_i, \bv{t}'_i} \in A'$.
We must show $\braket{f'(\bv{c}'), \tilde{f}'(\bv{t}')} \in A'$.
If for all $i\in [n']$ we have $\braket{\bv{c}_i, \bv{t}_i}\in A'$ then we have for all $i \in [n']$ that $\braket{\bv{c}_i, \bv{t}_i}\in A$ which implies $\braket{f'(\bv{c}'), \tilde{f}'(\bv{t}')} \in A$.
Suppose $f' \not = f$.
Then because the range of $f|_{C^n}$ is disjoint from the range of $f'|_{C^{n'}}$ we have $f(\bv{c}) \not = f'(\bv{c}')$ so we know $\braket{f'(\bv{c}'), \tilde{f}'(\bv{t}')} \in A'$.
Now suppose $f=f'$.
Suppose $\bv{c} \not = \bv{c}'$.
Then because $f|_{C^n}$ is injective we have $f(\bv{c}) \not = f'(\bv{c'})$ which means $\braket{f'(\bv{c}'), \tilde{f}'(\bv{t}')} \in A'$.
Finally, suppose $\bv{c} = \bv{c'}$.
Recall that, as a result of the induction hypothesis, $\bv{t}$ was the unique $\bv{t}$ satisfying $\braket{f(\bv{c}), \tilde{f}(\bv{t})} \in A$.
This means we must have $\bv{t} = \bv{t}'$ so that $\braket{f'(\bv{c}'), \tilde{f}'(\bv{t}')} = \braket{f(\bv{c}), \tilde{f}(\bv{t})}$.
But, because of the assumption that $\tilde{f}(\bv{t}) \not = s$ we must have $\braket{f'(\bv{c}'), \tilde{f}'(\bv{t}')} \in A'$.
From this we conclude that $A'\in H$ but we have $\braket{f(\bv{c}), s} \not \in A'$ but $\braket{f(\bv{c}), s}\in h$, this is a contradiction since $h = \bigcap H$.
We must then have $s = \tilde{f}(\bv{t})$.
We can apply the same argument to $s'$ to conclude $s' = \tilde{f}(\bv{t}) = s$.
This concludes the proof that $h$ is a functional relation.

We have proven that $h$ is a total functional relation so we have that $h$ is a function $h:C\to S$.

We will now show that $h$ satisfies the required conditions.
If $b\in B$ then we know $\braket{b, h_B(b)} \in h$ so that $h(b) = h_B(b)$ so that $h|_B = h_B$.
Now consider $f\in \mathcal{F}$ with $f:U^n \to U$ and $\bv{c} \in C^n$.
Define $\bv{s} = h^{(n)}(\bv{c})$ so that for all $i \in [n]$ that $\braket{\bv{c}_i, h(\bv{c}_i)} = \braket{\bv{c}_i, \bv{s}_i} \in h$.
This implies that $\braket{\bv{c}_i, \bv{s}_i} \in A$ for all $A\in H$.
The definition of $H$ then implies $\braket{f(\bv{c}), \tilde{f}(\bv{s})} \in A$ for all $A\in H$ so that $\braket{f(\bv{c}), \tilde{f}(\bv{s})} = \braket{f(\bv{c}), \tilde{f}(h^{(n)}(\bv{c})} \in h$.
Because $h:C \to S$ this means $h(f(\bv{c})) = \tilde{f}(h^{(n)}(\bv{c}))$.

Finally we prove that $h$ is the unique function satisfying $h|_B = h_B$ and for $f\in \mathcal{F}$ with $f:U^n \to U$ and $\bv{c}\in C^n$ that $h(f(\bv{c})) = \tilde{f}(h^{(n)}(\bv{c}))$.
Suppose $h'$ is another function satisfying these two conditions.
We prove by induction that $h' = h$, that is, for all $c\in C$ $h'(c) = h(c)$.
If $b\in B \subset C$ then
$$
h'(b) = h'|_B(b) = h_B(b) = h|_B(b) = h(b)
$$
Now suppose that for $\bv{c} \in C$ that for all $i\in [n]$ that $h'(\bv{c}_i) = h(\bv{c}_i)$.
This means that $h^{'(n)}(\bv{c}) = h^{(n)}(\bv{c})$
We then have
$$
h'(f(\bv{c})) = \tilde{f}(h^{'(n)}(\bv{c})) = \tilde{f}(h^{(n)}(\bv{c}) = h(f(\bv{c}))
$$
This concludes the proof by induction that $h'=h$.
\end{theorem}

\section{Peano Axioms}

%\begin{theorem}[Inductive Closure Coverage]
%Suppose $C = \mathbb{N}_{(U, B, \mathcal{F})}$.
%Consider
%$$
%\tilde{C} = \bigcup\left\{B, \bigcup\{x\in \mathcal{P}(C): \exists f \in \mathcal{F}(\forall n \in \mathcal{N}(f:U^n \to U \implies x = \text{Img}(f|_{C^n})))\}\right\}
%$$
%%$$
%%\tilde{C} = \bigcup \left\{B,  \bigcup\{\text{Img}(f) \in \mathcal{P}(C): f\in \mathcal{F}\} \right\}
%%$$
%
%We will show that $C = \tilde{C}$.
%
%First suppose $c\in \tilde{C}$
%Then either $c\in B$ in which case $c\in C$ because $C$ is $(U, B, \mathcal{F})$-inductive or there is some $f\in \mathcal{F}$ and $n\in \mathbb{N}$ so that $f:U^n \to U$ and $c\in \text{Img}(f|_{C^n})$.
%Suppose $f:U^n \to U$ and $c \in \text{Img}(f|_{C^n})$ there exists $\bv{c}\in C^n$ with $f(\bv{c}) = c$.
%Because $C$ is $(U, B, \mathcal{F})$-inductive this means $c = f(\bv{c}) \in C$.
%This means $\tilde{C} \subset C$.
%
%Now suppose $c\in C$.
%We will proceed by induction to show $c\in \tilde{C}$.
%We can see that if $c\in B$ then $c\in \tilde{C}$.
%Now suppose that for $f\in \mathcal{F}$ with $f:U^n \to U$ and consider $\mathbb{c}\in C^n$.
%Suppose that for all $i \in [n]$ we have $\bv{c}_i \in \tilde{C}$.
%Because $\tilde{C} \subset C$ this means $\bv{c}_i \in C$.
%This means that $f(\bv{c})\in \text{Img}(f|_{C^n}) \subset \tilde{C}$.
%This concludes the induction proof that $c\in \tilde{C}$ so that $C \subset \tilde{C}$.
%This means that every element of $C = \mathbb{N}_{(U, B, \mathcal{F})}$ is either an element of $B$ or in the image of an $f\in \mathcal{F}$ with $f:U^n \to U$ restricted to $(\mathbb{N}_{(U, B, \mathcal{F})})^n$.
%
%We see that $\tilde{C} = C$.
%\end{theorem}

\end{document}